TYPE=TRIGGERS
triggers='CREATE DEFINER=`root`@`%` TRIGGER `tri_vyrobky_insert_after` AFTER INSERT ON `vyrobky` FOR EACH ROW BEGIN\n	DECLARE v_druh CHAR(15);\n	SELECT dv.nazev INTO v_druh FROM druhy_vyrobku AS dv WHERE dv.id_druh = NEW.id_dru;\n	INSERT INTO vyrobky_zmeny VALUES(NEW.id_vyr, NEW.nazev, NEW.cena, v_druh, NEW.popis, NOW(), \'INSERT\', USER());\nEND' 'CREATE DEFINER=`root`@`%` TRIGGER `tri_vyrobky_update_before` BEFORE UPDATE ON `vyrobky` FOR EACH ROW BEGIN\n	DECLARE v_druh CHAR(15);\n	SELECT d.nazev INTO v_druh FROM druhy_vyrobku AS d WHERE d.id_druh = OLD.id_dru;\n	INSERT INTO vyrobky_zmeny VALUES(OLD.id_vyr, OLD.nazev, OLD.cena, v_druh, OLD.popis, NOW(), \'UPDATE\', USER() );\n    \n    SELECT d.nazev INTO v_druh FROM druhy_vyrobku AS d WHERE d.id_druh = NEW.id_dru;\n	INSERT INTO vyrobky_zmeny VALUES(NEW.id_vyr, NEW.nazev, NEW.cena, v_druh, NEW.popis, NOW(), \'UPDATE\', USER() );\n\nEND' 'CREATE DEFINER=`root`@`%` TRIGGER `tri_vyrobky_update_after` AFTER UPDATE ON `vyrobky` FOR EACH ROW BEGIN\n    DECLARE v_druh CHAR(15);\n    \n		SELECT dv.nazev INTO v_druh FROM druhy_vyrobku AS dv WHERE dv.id_druh = OLD.id_dru;\n        IF(OLD.cena != NEW.cena) THEN\n        INSERT INTO vyrobky_zmeny VALUES(OLD.id_vyr, OLD.nazev, OLD.cena, v_druh, OLD.popis, NOW(), \'up_cen\', USER());\n        END IF;\n        IF(OLD.nazev != NEW.nazev) THEN\n        INSERT INTO vyrobky_zmeny VALUES(OLD.id_vyr, OLD.nazev, OLD.cena, v_druh, OLD.popis, NOW(), \'up_naz\', USER());\n        END IF;\n        IF(OLD.popis != NEW.popis) THEN\n        INSERT INTO vyrobky_zmeny VALUES(OLD.id_vyr, OLD.nazev, OLD.cena, v_druh, OLD.popis, NOW(), \'up_pop\', USER());\n        END IF;\n        IF(OLD.id_dru != NEW.id_dru) THEN\n        INSERT INTO vyrobky_zmeny VALUES(OLD.id_vyr, OLD.nazev, OLD.cena, v_druh, OLD.popis, NOW(), \'up_dru\', USER());\n        END IF;\n        IF(OLD.id_vyr != NEW.id_vyr) THEN\n        INSERT INTO vyrobky_zmeny VALUES(OLD.id_vyr, OLD.nazev, OLD.cena, v_druh, OLD.popis, NOW(), \'up_idv\', USER());\n        END IF;\n \n	END' 'CREATE DEFINER=`root`@`%` TRIGGER `tri_vyrobky_delete_before` BEFORE DELETE ON `vyrobky` FOR EACH ROW BEGIN\n	DECLARE v_druh CHAR(15);\n    SELECT d.nazev INTO v_druh FROM druhy_vyrobku AS d WHERE d.id_druh = OLD.id_dru;\n    INSERT INTO vyrobky_zmeny VALUES(OLD.id_vyr, OLD.nazev, OLD.cena, v_druh, OLD.popis, NOW(), \'DELETE\', USER());\nEND'
sql_modes=524288 524288 524288 524288
definers='root@%' 'root@%' 'root@%' 'root@%'
client_cs_names='utf8mb4' 'utf8mb4' 'utf8mb4' 'utf8mb4'
connection_cl_names='utf8mb4_uca1400_ai_ci' 'utf8mb4_uca1400_ai_ci' 'utf8mb4_uca1400_ai_ci' 'utf8mb4_uca1400_ai_ci'
db_cl_names='utf8mb4_general_ci' 'utf8mb4_general_ci' 'utf8mb4_general_ci' 'utf8mb4_general_ci'
created=1729629495691502 1729629495786952 1729629495739680 1729629495664471
